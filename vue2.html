<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue 2 CDN Example</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>

    <script src="https://unpkg.com/pdf-lib@1.11.0"></script>
    <script src="https://unpkg.com/downloadjs@1.4.7"></script>
    <script src="https://cdn.jsdelivr.net/npm/@pdf-lib/fontkit@1.1.1/dist/fontkit.umd.min.js"></script>
    <style>
        #pdf-container {
            height: 700px;
            display: flex;
        }
    </style>
</head>

<body>

    <div id="app">

        <div id="pdf-container"></div>

    </div>

    <script>
        new Vue({
            el: '#app',
            mounted() {
                this.displayPDF('fill-form.pdf')
            },
            data: {
                title: 'Vue 2 CDN Example',
                newItem: '',
                items: ['Item 1', 'Item 2', 'Item 3']
            },
            methods: {
                async arrayBufferToBase64(buffer) {
                    let binary = ''
                    const bytes = new Uint8Array(buffer)
                    for (let i = 0; i < bytes.byteLength; i++) {
                        binary += String.fromCharCode(bytes[i])
                    }
                    return window.btoa(binary)
                },
                async displayPDF(pdfPath) {
                    try {
                        const { PDFDocument } = PDFLib
                        const fontkit = window.fontkit

                        // โหลด PDF file
                        const existingPdfBytes = await fetch(pdfPath).then(res => res.arrayBuffer())
                        const pdfDoc = await PDFDocument.load(existingPdfBytes)

                        // แปลง PDF เป็น base64
                        const pdfBytes = await pdfDoc.save()
                        const base64String = await this.arrayBufferToBase64(pdfBytes)

                        // สร้าง URL object
                        const pdfUrl = `data:application/pdf;base64,${base64String}`

                        // แสดงใน HTML โดยใช้ iframe หรือ embed
                        const viewer = document.createElement('iframe')
                        viewer.src = pdfUrl
                        viewer.style.width = '100%'
                        viewer.style.height = '90%'
                        document.getElementById('pdf-container').appendChild(viewer)

                    } catch (error) {
                        console.error('Error loading PDF:', error)
                    }
                }
            }
        });
    </script>

</body>

</html>